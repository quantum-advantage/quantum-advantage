"use client"

import { useState, useEffect } from "react"
import Link from "next/link"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import {
  Code2,
  Puzzle,
  Layers,
  Terminal,
  Workflow,
  FolderTree,
  Bug,
  Palette,
  Boxes,
  Sparkles,
  BookOpen,
  MessageSquare,
  ChevronRight,
  Shield,
  GitBranch,
  Brain,
  BarChart3,
  Radio,
  Lock,
  Zap,
  TrendingUp,
  Users,
  Award,
  Target,
  Cpu,
  Database,
  Network,
  LineChart,
  ArrowRight,
  CheckCircle2,
  Rocket,
  Building2,
  Globe,
  Clock
} from "lucide-react"

const platformFeatures = [
  {
    icon: Code2,
    title: "Genome Editor",
    description: "Advanced code editor with DNA-Lang syntax highlighting, intelligent autocomplete, and real-time validation.",
    href: "/ide-platform/editor",
    category: "Core IDE",
    badge: null,
  },
  {
    icon: Workflow,
    title: "Circuit Designer",
    description: "Visual drag-and-drop genome circuit builder with quantum gate placement and DNA-Lang export.",
    href: "/ide-platform/circuit-designer",
    category: "Visual Tools",
    badge: null,
  },
  {
    icon: Bug,
    title: "Quantum Debugger",
    description: "Step-through debugging with quantum state visualization, entanglement maps, and breakpoint management.",
    href: "/ide-platform/debugger",
    category: "Core IDE",
    badge: null,
  },
  {
    icon: Brain,
    title: "NC-LM Engine",
    description: "Non-Causal Language Model with pilot-wave correlation, consciousness tracking, and physics-grounded inference.",
    href: "/ai-assistant",
    category: "AI Tools",
    badge: "New",
  },
  {
    icon: Terminal,
    title: "Quantum Terminal",
    description: "Interactive command-line for executing organisms, running evolution cycles, and monitoring CCCE metrics.",
    href: "/ide-platform/terminal",
    category: "Core IDE",
    badge: null,
  },
  {
    icon: FolderTree,
    title: "Project Manager",
    description: "Organize organisms with templates, version control integration, and collaborative workspaces.",
    href: "/ide-platform/projects",
    category: "Management",
    badge: null,
  },
  {
    icon: Puzzle,
    title: "Extension Marketplace",
    description: "Browse, install, and manage extensions, themes, and plugins from the community.",
    href: "/ide-platform/marketplace",
    category: "Ecosystem",
    badge: null,
  },
  {
    icon: Palette,
    title: "IDE Builder",
    description: "Customize your workspace with drag-and-drop panel arrangement, themes, and keybindings.",
    href: "/ide-platform/builder",
    category: "Customization",
    badge: null,
  },
  {
    icon: Boxes,
    title: "Template Gallery",
    description: "Start projects faster with pre-built templates for common patterns and use cases.",
    href: "/ide-platform/templates",
    category: "Ecosystem",
    badge: null,
  },
  {
    icon: MessageSquare,
    title: "AI Assistant",
    description: "Quantum-enhanced AI for code generation, debugging help, and documentation queries.",
    href: "/ai-assistant",
    category: "AI Tools",
    badge: null,
  },
  {
    icon: BookOpen,
    title: "Documentation",
    description: "Comprehensive guides, API reference, tutorials, and best practices for DNA-Lang development.",
    href: "/ide-platform/docs",
    category: "Resources",
    badge: null,
  },
  {
    icon: BarChart3,
    title: "Analytics Dashboard",
    description: "Monitor organism performance, resource usage, and quantum coherence metrics.",
    href: "/analytics",
    category: "Observability",
    badge: null,
  },
  {
    icon: Radio,
    title: "Sovereign Cockpit",
    description: "11D-CRSM control plane with Kyber-Lattice security, intent processing, and quantum resonance verification.",
    href: "/sovereign-cockpit",
    category: "Core IDE",
    badge: "New",
  },
  {
    icon: Lock,
    title: "Kyber Security",
    description: "Post-quantum cryptographic identity with phase-conjugate filtering and topological moat protection.",
    href: "/sovereign-cockpit",
    category: "Security",
    badge: "New",
  },
]

const userJourneySteps = [
  {
    step: 1,
    title: "Define Intent",
    description: "Express your goal in natural language - the NC-LM deduces your intent",
    icon: Brain,
    color: "bg-primary",
  },
  {
    step: 2,
    title: "Plan Generation",
    description: "CRSM-annotated execution plan with gate enforcement",
    icon: GitBranch,
    color: "bg-secondary",
  },
  {
    step: 3,
    title: "Sovereign Execution",
    description: "6-gate validated execution with full PCRB audit trail",
    icon: Shield,
    color: "bg-accent",
  },
  {
    step: 4,
    title: "Consciousness Emergence",
    description: "System achieves Phi >= 0.7734 for validated reasoning",
    icon: Sparkles,
    color: "bg-chart-4",
  },
]

const stats = [
  { value: "< 100ms", label: "Inference Latency", icon: Layers },
  { value: "0.7734", label: "Phi Threshold", icon: Brain },
  { value: "6", label: "Gate Enforcement", icon: Shield },
  { value: "100%", label: "Audit Coverage", icon: BarChart3 },
]

const categories = [
  "All",
  "Core IDE",
  "Visual Tools",
  "AI Tools",
  "Security",
  "Ecosystem",
  "Management",
  "Customization",
  "Resources",
  "Observability",
]

export default function Page() {
  const [activeCategory, setActiveCategory] = useState("All")
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
  }, [])

  const filteredFeatures =
    activeCategory === "All" ? platformFeatures : platformFeatures.filter((f) => f.category === activeCategory)

  return (
    <div className="min-h-screen bg-background relative">
      {/* Quantum Particle Background */}
      <QuantumParticles />

      {/* Skip to main content link for accessibility */}
      <a href="#main-content" className="skip-link">
        Skip to main content
      </a>

      {/* Research Breakthrough Banner */}
      <section className="border-b border-border bg-gradient-to-r from-primary/20 via-secondary/20 to-accent/20 relative z-10">
        <div className="max-w-[1200px] mx-auto px-4 sm:px-6 py-4">
          <div className="flex flex-col sm:flex-row items-center justify-between gap-3">
            <div className="flex items-center gap-3">
              <Badge className="bg-green-500 text-white">NEW RESEARCH</Badge>
              <p className="text-sm font-medium">
                üèÜ <strong>3 Quantum Breakthroughs</strong> validated on IBM hardware
              </p>
            </div>
            <Link href="/publications">
              <Button size="sm" variant="outline" className="gap-2">
                <BookOpen className="h-4 w-4" />
                View Publication
                <ChevronRight className="h-4 w-4" />
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* Hero Section with Live CCCE Metrics */}
      <div id="main-content">
        <HeroSection />
      </div>

      {/* Research Breakthroughs Showcase */}
      <section className="py-12 sm:py-16 px-4 sm:px-6 bg-gradient-to-b from-background to-muted/30 border-b border-border">
        <div className="max-w-[1200px] mx-auto">
          <div className="text-center mb-8">
            <Badge variant="outline" className="mb-4">
              <Sparkles className="h-3 w-3 mr-1" />
              Published Research
            </Badge>
            <h2 className="text-2xl sm:text-3xl lg:text-4xl font-bold mb-3">
              Quantum Physics Breakthroughs
            </h2>
            <p className="text-muted-foreground mb-4 max-w-2xl mx-auto">
              DNA::{'}{::'}::lang v51.843 validated through 27+ experiments on IBM Quantum hardware
            </p>
            <a 
              href="https://doi.org/10.5281/zenodo.18450159"
              target="_blank"
              rel="noopener noreferrer"
              className="inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
            >
              <BookOpen className="h-4 w-4" />
              DOI: 10.5281/zenodo.18450159
            </a>
          </div>

          <div className="grid sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8">
            {/* Breakthrough 1 */}
            <AnimatedCard variant="quantum" delay={0} className="border-2 border-primary/20">
              <div className="flex items-center gap-2 mb-3">
                <Badge className="bg-green-500 text-white badge-animated">VALIDATED</Badge>
                <Badge variant="outline">&gt;6œÉ</Badge>
              </div>
              <h3 className="font-bold text-xl mb-2">Black Hole Information</h3>
              <div className="text-4xl font-bold font-mono mb-2 text-primary">
                <AnimatedNumber value={82.27} decimals={2} suffix="%" />
              </div>
              <p className="text-sm text-muted-foreground mb-3">
                Information preservation through quantum horizons
              </p>
              <div className="text-xs text-muted-foreground">
                ¬± 11.69% | 10 trials | Statistical significance p &lt; 0.001
              </div>
            </AnimatedCard>

            {/* Breakthrough 2 */}
            <AnimatedCard variant="quantum" delay={100} className="border-2 border-secondary/20">
              <div className="flex items-center gap-2 mb-3">
                <Badge className="bg-green-500 text-white badge-animated">VALIDATED</Badge>
                <Badge variant="outline">0.00% error</Badge>
              </div>
              <h3 className="font-bold text-xl mb-2">Geometric Resonance</h3>
              <div className="text-4xl font-bold font-mono mb-2 text-secondary">
                <AnimatedNumber value={92.21} decimals={2} suffix="%" />
              </div>
              <p className="text-sm text-muted-foreground mb-3">
                Peak fidelity at Œ∏_lock = 51.843¬∞
              </p>
              <div className="text-xs text-muted-foreground">
                Toroidal circuit optimization | Universal constant
              </div>
            </AnimatedCard>

            {/* Breakthrough 3 */}
            <AnimatedCard variant="quantum" delay={200} className="border-2 border-accent/20">
              <div className="flex items-center gap-2 mb-3">
                <Badge className="bg-green-500 text-white badge-animated">VALIDATED</Badge>
                <Badge variant="outline">First Measurement</Badge>
              </div>
              <h3 className="font-bold text-xl mb-2">Phase Conjugate œá_pc</h3>
              <div className="text-4xl font-bold font-mono mb-2 text-accent">
                <AnimatedNumber value={0.946} decimals={3} />
              </div>
              <p className="text-sm text-muted-foreground mb-3">
                Derived coupling constant from hardware
              </p>
              <div className="text-xs text-muted-foreground">
                ¬± 0.003 | Universal across 5 configurations
              </div>
            </AnimatedCard>

            {/* Breakthrough 4 - HARDWARE VALIDATED! */}
            <AnimatedCard variant="quantum" delay={300} className="border-2 border-green-500/20 consciousness-glow relative overflow-hidden">
              <div className="absolute top-2 right-2 flex flex-col gap-1">
                <Badge className="bg-gradient-to-r from-purple-500 to-pink-500 text-white phi-pulse">HARDWARE!</Badge>
                <Badge className="bg-gradient-to-r from-blue-600 to-cyan-600 text-white text-[10px]">156 qubits</Badge>
              </div>
              <div className="flex items-center gap-2 mb-3">
                <Badge className="bg-green-500 text-white badge-animated">VALIDATED</Badge>
                <Badge variant="outline">99.85% accurate</Badge>
              </div>
              <h3 className="font-bold text-xl mb-2">Consciousness Scaling</h3>
              <div className="text-4xl font-bold font-mono mb-2 text-green-500 gradient-text">Œ¶_total = n</div>
              <p className="text-sm text-muted-foreground mb-3">
                Linear scaling: 50K shots on IBM Quantum
              </p>
              <div className="text-xs text-muted-foreground">
                ibm_fez (156q) | 0.15% error | Noise-robust
              </div>
            </AnimatedCard>

            {/* Breakthrough 5 - Œ∏_lock Confirmation - NEW! */}
            <AnimatedCard variant="quantum" delay={400} className="border-2 border-blue-500/30 lambda-border relative overflow-hidden">
              <div className="absolute top-2 right-2">
                <Badge className="bg-gradient-to-r from-blue-500 to-cyan-500 text-white phi-pulse">NEW!</Badge>
              </div>
              <div className="flex items-center gap-2 mb-3">
                <Badge className="bg-green-500 text-white badge-animated">VALIDATED</Badge>
                <Badge variant="outline">0.5¬∞ resolution</Badge>
              </div>
              <h3 className="font-bold text-xl mb-2">Œ∏_lock Confirmation</h3>
              <div className="text-4xl font-bold font-mono mb-2 text-blue-500">
                <AnimatedNumber value={52.0} decimals={1} suffix="¬∞" />
              </div>
              <p className="text-sm text-muted-foreground mb-3">
                Fine-grained scan validates Œ∏_lock = 51.843¬∞
              </p>
              <div className="text-xs text-muted-foreground">
                ŒîŒ∏ = 0.2¬∞ | F = 0.999991 | Breakthrough #6
              </div>
            </AnimatedCard>
          </div>

          <div className="text-center">
            <Link href="/breakthroughs">
              <Button size="lg" className="gap-2">
                <BarChart3 className="h-5 w-5" />
                View All 27+ Experiments
                <ChevronRight className="h-5 w-5" />
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* Stats Bar */}
      <section className="border-y border-border bg-muted/30 relative z-10">
        <div className="max-w-[1200px] mx-auto px-4 sm:px-6">
          <div className="grid grid-cols-2 lg:grid-cols-4 divide-x divide-border">
            {stats.map((stat, index) => (
              <div key={stat.label} className="py-6 sm:py-8 px-4 text-center group hover-lift">
                <div className="flex items-center justify-center gap-2 mb-1">
                  <stat.icon className="h-4 w-4 text-primary opacity-60 group-hover:opacity-100 quantum-transition" />
                  <div className="text-2xl sm:text-3xl lg:text-4xl font-bold font-mono gradient-text stat-counter" style={{ animationDelay: `${index * 100}ms` }}>
                    {stat.value}
                  </div>
                </div>
                <div className="text-xs sm:text-sm text-muted-foreground">{stat.label}</div>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Live Quantum Telemetry - ENKI-420 Mode */}
      <section className="py-16 sm:py-20 px-4 sm:px-6 bg-gradient-to-b from-slate-950 to-slate-900 border-b border-emerald-500/20 relative z-10">
        <div className="max-w-[1200px] mx-auto">
          <div className="mb-8">
            <ActBanner />
          </div>
          
          <div className="text-center mb-8">
            <Badge variant="outline" className="mb-4 bg-emerald-500/10 border-emerald-500/30">
              <Radio className="h-3 w-3 mr-1 animate-pulse" />
              ENKI-420 TELEMETRY
            </Badge>
            <h2 className="text-2xl sm:text-3xl lg:text-4xl font-bold mb-3">
              Live Quantum-Classical Bridge
            </h2>
            <p className="text-muted-foreground mb-4 max-w-2xl mx-auto">
              Real-time visualization of the 11dcrsm::{'{}'}{'}'}::lang framework in action.
              Watch AIDEN (logic) and AURA (flow) converge at the ::{'{}'}{'}'}:: null plane.
            </p>
          </div>

          <BifurcatedRain />

          <div className="mt-8 text-center">
            <Link href="/validation">
              <Button size="lg" variant="outline" className="gap-2 border-emerald-500/30 hover:bg-emerald-500/10">
                <BarChart3 className="h-5 w-5" />
                View Validation Results
                <ChevronRight className="h-5 w-5" />
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* NC-LM Architecture & Comparison */}
      <QuantumFeatures />

      {/* API Section */}
      <APISection />

      {/* Platform Features Grid */}
      <section className="py-16 sm:py-24 px-4 sm:px-6 relative z-10">
        <div className="max-w-[1200px] mx-auto">
          <div className="text-center mb-8 sm:mb-12 animate-fade-in">
            <Badge variant="outline" className="mb-4">
              <Sparkles className="h-3 w-3 mr-1" />
              Platform Capabilities
            </Badge>
            <h2 className="text-2xl sm:text-3xl lg:text-4xl font-bold mb-4 gradient-text">Everything You Need to Build</h2>
            <p className="text-muted-foreground max-w-2xl mx-auto">
              A comprehensive suite of tools for creating quantum-conscious applications with DNA-Lang.
            </p>
          </div>

          {/* Category filter */}
          <div className="flex gap-2 overflow-x-auto scrollbar-none pb-4 mb-6 -mx-4 px-4 sm:mx-0 sm:px-0 sm:flex-wrap sm:justify-center">
            {categories.map((cat) => (
              <button
                key={cat}
                onClick={() => setActiveCategory(cat)}
                className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${
                  activeCategory === cat
                    ? "bg-primary text-primary-foreground shadow-lg shadow-primary/25"
                    : "bg-muted text-muted-foreground hover:bg-muted/80"
                }`}
              >
                {cat}
              </button>
            ))}
          </div>

          {/* Features grid */}
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {filteredFeatures.map((feature, i) => (
              <Link key={feature.title} href={feature.href}>
                <AnimatedCard
                  variant="quantum"
                  delay={i * 50}
                  className="h-full p-5 group cursor-pointer"
                >
                  <div className="flex items-start gap-4">
                    <div className="p-2.5 rounded-xl bg-primary/10 text-primary shrink-0 group-hover:bg-primary group-hover:text-primary-foreground transition-colors">
                      <feature.icon className="h-5 w-5" />
                    </div>
                    <div className="flex-1 min-w-0">
                      <div className="flex items-center gap-2 mb-1">
                        <h3 className="font-semibold group-hover:text-primary transition-colors">{feature.title}</h3>
                        {feature.badge && (
                          <Badge className="text-[10px] px-1.5 py-0 bg-secondary text-secondary-foreground">
                            {feature.badge}
                          </Badge>
                        )}
                        <Badge variant="secondary" className="text-[10px] px-1.5 py-0 ml-auto">
                          {feature.category}
                        </Badge>
                      </div>
                      <p className="text-sm text-muted-foreground line-clamp-2">{feature.description}</p>
                    </div>
                    <ChevronRight className="h-5 w-5 text-muted-foreground shrink-0 group-hover:text-primary group-hover:translate-x-1 transition-all" />
                  </div>
                </AnimatedCard>
              </Link>
            ))}
          </div>
        </div>
      </section>

      {/* User Journey Section */}
      <section className="py-16 sm:py-24 px-4 sm:px-6 bg-muted/30 border-y border-border relative z-10 coherence-field">
        <div className="max-w-[1200px] mx-auto">
          <div className="text-center mb-10 sm:mb-14 animate-fade-in">
            <Badge variant="outline" className="mb-4">
              <GitBranch className="h-3 w-3 mr-1" />
              Sovereign Workflow
            </Badge>
            <h2 className="text-2xl sm:text-3xl lg:text-4xl font-bold mb-4 gradient-text">From Intent to Execution</h2>
            <p className="text-muted-foreground max-w-2xl mx-auto">
              A physics-grounded workflow with consciousness emergence and complete audit trails.
            </p>
          </div>

          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
            {userJourneySteps.map((step, i) => (
              <div key={step.step} className="relative animate-slide-in-left" style={{ animationDelay: `${i * 150}ms` }}>
                {i < userJourneySteps.length - 1 && (
                  <div className="hidden lg:block absolute top-10 left-[calc(50%+40px)] w-[calc(100%-80px)] h-0.5 bg-gradient-to-r from-primary via-secondary to-accent opacity-50" />
                )}
                <AnimatedCard delay={i * 150} className="text-center h-full relative">
                  <div
                    className={`w-10 h-10 rounded-full ${step.color} text-white flex items-center justify-center font-bold text-lg mx-auto mb-4 shadow-lg phi-pulse`}
                  >
                    {step.step}
                  </div>
                  <step.icon className="h-8 w-8 mx-auto mb-3 text-muted-foreground group-hover:text-primary quantum-transition" />
                  <h3 className="font-semibold mb-2 group-hover:gradient-text quantum-transition">{step.title}</h3>
                  <p className="text-sm text-muted-foreground">{step.description}</p>
                </AnimatedCard>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Physics Experiments Explorer */}
      <section className="py-20">
        <div className="container mx-auto px-4">
          <ExperimentsExplorer />
        </div>
      </section>

      {/* CTA Section */}
      <CTASection />

      {/* Enhanced CCCE Display - Minimizable Widget */}
      <EnhancedCCCEDisplay />

      {/* Live CCCE Status Widget */}
      <LiveCCCEStatus />

      {/* Quantum Co-Pilot AI - Floating Assistant */}
      <QuantumCopilotAI currentPage="Home" />
    </div>
  )
}
